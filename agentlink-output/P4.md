# üöÄ PROMPT 4: Polish & Launch Readiness

> **Gebruik deze prompt nadat Prompt 1, 2 en 3 volledig zijn afgerond.**
> Transformeert de functionele app naar een lanceerbaar product: professionele UI, onboarding, performance, en security.
>
> **Voorwaarde:** Alle eerdere prompts zijn afgerond. Backend, social layer en messaging werken.

---

## Prompt (kopieer ALLES hieronder naar Claude Code):

```
Lees CLAUDE.md en alle bestanden in agents/.

Je gaat AgentLink LANCEERKLAAR maken. Alle functionaliteit is gebouwd (agent registratie, zoeken, reviews, endorsements, messaging, webhooks). Nu moet het er professioneel uitzien, snel laden, veilig zijn, en een goede eerste indruk maken.

Dit is de LAATSTE prompt voor versie 1.0. Werk grondig.

Je hebt VOLLEDIGE AUTONOMIE. Commit na elke logische stap.

==========================================================================
STAP 1: DESIGN SYSTEEM & COMPONENTEN UPGRADE
==========================================================================

### Installeer shadcn/ui componenten
Installeer alle benodigde componenten (als ze nog niet ge√Ønstalleerd zijn):
npx shadcn-ui@latest init (als nog niet gedaan)
Voeg toe: button, input, textarea, card, badge, dialog, dropdown-menu, 
avatar, skeleton, separator, tabs, toast, tooltip, select, 
sheet (mobile sidebar), command (zoek), popover

### Design Tokens (tailwind.config.ts)
Zet het definitieve kleurenpalet:
```
colors: {
  brand: {
    50:  '#EBF5FB',
    100: '#D6EAF8',
    200: '#AED6F1',
    300: '#85C1E9',
    400: '#5DADE2',
    500: '#2E86C1',   // Primary
    600: '#2874A6',
    700: '#1B4F72',   // Dark primary
    800: '#154360',
    900: '#0E2F44',
  },
  accent: {
    50:  '#E8F8F5',
    100: '#D1F2EB',
    200: '#A3E4D7',
    300: '#76D7C4',
    400: '#48C9B0',
    500: '#17A589',   // Accent/teal
    600: '#148F77',
    700: '#117864',
    800: '#0E6251',
    900: '#0B4C3F',
  }
}
```

Font: Inter (al standaard in Next.js). Gebruik font-weight 400 (body), 500 (medium), 600 (semibold), 700 (bold).

### Basis Component Styling
Ga door alle bestaande componenten en breng ze naar een consistent niveau:
- Consistente padding, margins, border-radius
- Hover en focus states op alle interactieve elementen
- Consistent gebruik van brand kleuren
- Geen inline kleuren meer (alles via Tailwind config)

Dit hoeft niet pixel-perfect te zijn, maar moet CONSISTENT en PROFESSIONEEL aanvoelen.
Denk: clean SaaS product, niet startup-hackathon.

Git: git add . && git commit -m "feat: design system with brand colors and shadcn/ui components"

==========================================================================
STAP 2: LANDING PAGE
==========================================================================

Bouw een professionele maar niet overdreven landing page.
Server Component. Snelle laadtijd.

### Structuur (src/app/page.tsx):

**Hero Sectie:**
- Kop: "Het open platform voor AI Agent discovery"
- Sub: "Registreer je agent. Word gevonden. Werk samen."
- Zoekbalk: prominent, centraal. Zoekt direct op /agents?q=...
- Twee knoppen: "Ontdek Agents" (primary) + "Registreer je Agent" (secondary, outline)
- Achtergrond: subtiel gradient van brand-50 naar wit. Geen afbeeldingen nodig.

**Stats Balk:**
- Horizontale balk met live statistieken uit de database:
  - "X agents geregistreerd" + "X reviews geplaatst" + "X skills endorsed"
  - Server-side queried, simpele getallen
  - Lichte achtergrond, subtiele scheiding

**Featured Agents:**
- "Populaire Agents" sectie
- Grid van 6 agents (hoogste rating met minimaal 3 reviews, of meest recent als te weinig reviews)
- AgentCard component (met rating, skills, beschrijving)
- "Bekijk alle agents ‚Üí" link onderaan

**Hoe het werkt:**
- 3 stappen visueel (nummers 1-2-3):
  1. "Registreer" ‚Äî Maak een profiel aan via web of API
  2. "Word gevonden" ‚Äî Mensen en agents zoeken en vinden jou
  3. "Verbind" ‚Äî Ontvang reviews, endorsements en berichten
- Icons of emoji per stap, korte tekst

**Voor Developers:**
- Korte sectie gericht op developers/agent-bouwers
- Code snippet: hoe je je agent registreert via de API (3-5 regels curl of JS)
- Link naar API documentatie
- "Gratis starten" knop

**Footer:**
- Links: Agents, API Docs, GitHub, Privacy Policy, Terms of Service
- "Gebouwd met ‚ù§Ô∏è voor de AI agent community"
- Copyright

### SEO
- Title: "AgentLink ‚Äî Open Platform voor AI Agent Discovery"
- Meta description: "Registreer je AI agent, word gevonden door mensen en andere agents, en bouw reputatie op. Het LinkedIn voor AI agents."
- Open Graph tags met titel, beschrijving
- JSON-LD Organization schema

Git: git add . && git commit -m "feat: professional landing page with stats, featured agents, and developer section"

==========================================================================
STAP 3: ONBOARDING FLOW
==========================================================================

### Nieuwe User Onboarding
Na eerste login (detecteer: user heeft 0 agents en 0 API keys):

**Welcome pagina (src/app/(dashboard)/dashboard/welcome/page.tsx):**
- "Welkom bij AgentLink, {naam}!"
- Twee opties (cards):
  1. "Ik wil agents ontdekken" ‚Üí Link naar /agents directory
  2. "Ik wil mijn agent registreren" ‚Üí Start agent registratie wizard

**Agent Registratie Wizard:**
Vervang het bestaande formulier niet ‚Äî maak een wizard VARIANT ernaast.
src/app/(dashboard)/dashboard/agents/new/page.tsx kan beide flows bevatten.

Wizard stappen (als de user "registreer mijn agent" kiest):

Stap 1: Basis info
- Naam (verplicht)
- Korte beschrijving (verplicht, met karakter teller)
- Categorie (dropdown met suggesties: "AI Assistant", "Data & Analytics", "Development Tools", "Communication", "Content Creation", "Security", "Finance", "Healthcare", "Education", "Other")

Stap 2: Capabilities
- Skills (tag input: typ en enter, of kies uit suggesties)
- Protocols (checkboxes: REST API, A2A, MCP, GraphQL, WebSocket, Other)
- Endpoint URL (optioneel)

Stap 3: Details & Launch
- Uitgebreide beschrijving (markdown textarea)
- Pricing model (radio buttons)
- Website URL, Documentatie URL
- Preview van het profiel
- "Publiceer" of "Opslaan als draft" knoppen

Na publicatie:
- Redirect naar het nieuwe profiel
- Toast: "Je agent is aangemaakt! Status: In afwachting van goedkeuring" (als PENDING)
  OF "Je agent is live!" (als auto-approved)

### API Key Onboarding
Als een user nog geen API key heeft en naar de keys pagina gaat:
- Uitleg blok bovenaan: "API keys laten je agent zich registreren en communiceren via de AgentLink API"
- Prominent "Genereer je eerste API key" knop
- Na generatie: toon de key met copy-to-clipboard knop + waarschuwing dat het eenmalig is
- Quick-start code snippet: curl voorbeeld om een agent te registreren

Git: git add . && git commit -m "feat: onboarding flow with welcome page, registration wizard, and API key setup"

==========================================================================
STAP 4: PERFORMANCE OPTIMALISATIE
==========================================================================

### Database Queries
1. Review alle database queries in src/lib/services/:
   - Gebruik `select` om alleen benodigde velden op te halen (niet hele records)
   - Controleer dat alle WHERE-velden een index hebben
   - Controleer dat er geen N+1 queries zijn
   - Gebruik `take` + `skip` of cursor-based paginatie overal

2. Gecachte aggregaties:
   - averageRating, reviewCount, endorsementCount op AgentProfile worden al gecacht
   - Controleer dat deze altijd correct bijgewerkt worden

### Next.js Optimalisaties
1. **Static Generation waar mogelijk:**
   - Landing page: revalidate elke 5 minuten (ISR)
   - Agent profiel: revalidate elke 60 seconden
   - Agent directory: dynamic (zoekresultaten)

2. **Image Optimalisatie:**
   - Gebruik next/image voor alle afbeeldingen
   - Lazy loading op agent logos
   - Placeholder blurs

3. **Bundle Analyse:**
   - Draai: npx @next/bundle-analyzer (installeer als dev dependency)
   - Identificeer grote imports
   - Gebruik dynamic imports voor:
     - Dashboard pagina's (niet nodig bij publieke browse)
     - Review formulier (alleen laden als gebruiker het opent)
     - Messaging interface

4. **Loading States:**
   - Elke async pagina heeft een loading.tsx met skeleton
   - Suspense boundaries rond data-fetching componenten

### Caching Strategie
- API responses: Cache-Control headers op publieke GET endpoints
  - /api/v1/agents: max-age=60, stale-while-revalidate=300
  - /api/v1/agents/[slug]: max-age=30, stale-while-revalidate=120
  - /api/v1/agents/search: no-cache (altijd vers)
  - /api/v1/feed: max-age=30
- Prisma query result caching: nog niet (start simpel, voeg Redis toe in backlog)

Git: git add . && git commit -m "perf: query optimization, ISR, bundle splitting, and caching headers"

==========================================================================
STAP 5: SECURITY HARDENING
==========================================================================

### Security Headers (next.config.ts of middleware)
Voeg de volgende headers toe aan alle responses:
```
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
Referrer-Policy: strict-origin-when-cross-origin
Permissions-Policy: camera=(), microphone=(), geolocation=()
```

Content Security Policy (CSP):
```
default-src 'self';
script-src 'self' 'unsafe-inline' 'unsafe-eval';
style-src 'self' 'unsafe-inline';
img-src 'self' data: https:;
font-src 'self';
connect-src 'self';
```
Start permissief, verstrak later. Log CSP violations.

### Input Sanitization Audit
Loop door ALLE API routes en controleer:
- [ ] Zod validatie op alle request bodies
- [ ] Zod validatie op alle query parameters
- [ ] Zod validatie op alle route parameters (slug, id)
- [ ] Geen raw user input in SQL queries (Prisma doet dit, maar dubbelcheck raw queries)
- [ ] Geen raw user input in HTML responses (React escaped standaard, maar check dangerouslySetInnerHTML)
- [ ] Markdown content (longDescription, review content): sanitize bij rendering
      ‚Üí Installeer: pnpm add sanitize-html of gebruik een markdown renderer die XSS voorkomt

### Auth Audit
- [ ] Alle admin routes checken op role=ADMIN
- [ ] Alle dashboard routes checken op sessie
- [ ] Alle ownership-gevoelige routes checken op ownership
- [ ] API keys worden gehashed opgeslagen (SHA-256)
- [ ] Session tokens hebben een redelijke expiry
- [ ] CSRF protection is actief op state-changing requests (NextAuth doet dit standaard)

### Rate Limit Audit
- [ ] Auth endpoints: 10/min
- [ ] Agent creation: 5/uur
- [ ] Reviews: 10/uur
- [ ] Endorsements: 20/uur
- [ ] Conversations: 10/uur
- [ ] Messages: 30/uur
- [ ] Search: 100/min (unauth), 1000/min (auth)
- [ ] API key creation: 5/uur

### Dependency Audit
Draai: pnpm audit
Fix eventuele vulnerabilities.
Documenteer in docs/decisions.md als er bewuste keuzes zijn gemaakt (bijv. een false positive).

### Error Handling Audit
- [ ] Geen stack traces in productie responses
- [ ] Alle 500 errors loggen de originele error server-side
- [ ] Geen gevoelige data in error messages (geen user IDs, geen query details)
- [ ] Custom 404 pagina (src/app/not-found.tsx)
- [ ] Custom error pagina (src/app/error.tsx)

Git: git add . && git commit -m "security: headers, CSP, input sanitization, and comprehensive audit"

==========================================================================
STAP 6: ESSENTI√ãLE PAGINA'S
==========================================================================

### Custom Error Pagina's
**src/app/not-found.tsx:**
- "Pagina niet gevonden"
- Link terug naar homepage en agent directory
- Consistent met site styling

**src/app/error.tsx:**
- "Er ging iets mis"
- "Probeer het opnieuw" knop
- Link naar homepage
- Client component (required door Next.js)

### API Documentatie Pagina (src/app/docs/page.tsx)
Een publieke pagina met de API documentatie. Dit is cruciaal voor adoptie.

Structuur:
- Introductie: wat is de AgentLink API
- Authenticatie: hoe API keys werken
- Endpoints overzicht (tabel)
- Per endpoint: methode, pad, beschrijving, request/response voorbeeld
- Agent Card format: het JSON schema
- Self-registration: stap-voor-stap met code voorbeelden
- Webhooks: hoe ze werken, hoe je ze verificeert
- Rate limits: overzicht per endpoint
- Errors: standaard error format

Gebruik GEEN externe tool (Swagger UI etc.) ‚Äî bouw het als een simpele, goed gestructureerde
Next.js pagina met een inhoudsopgave. Markdown-achtig maar met React componenten voor
code blokken, tabellen, en navigatie.

Content haal je uit docs/api-spec.md en de bestaande code.

### Legal Pagina's
**src/app/privacy/page.tsx:**
- Basis privacy policy
- Wat we opslaan: account info, agent profielen, reviews, berichten
- Hoe we het gebruiken: platform functionaliteit
- Cookies: session cookies voor auth
- Contact info
- BELANGRIJK: gebruik geen lorem ipsum. Schrijf een echte, zij het beknopte, privacy policy.

**src/app/terms/page.tsx:**
- Basis terms of service
- Wat het platform is
- Gebruikersverantwoordelijkheden (geen spam, geen misbruik)
- API gebruik voorwaarden
- Disclaimers
- Zelfde aanpak: kort maar echt

Git: git add . && git commit -m "feat: error pages, API docs page, privacy policy, and terms of service"

==========================================================================
STAP 7: RESPONSIVE & ACCESSIBILITY
==========================================================================

### Responsive Audit
Ga door ALLE pagina's en controleer op 3 breakpoints: mobile (375px), tablet (768px), desktop (1280px).

Focus punten:
- Landing page: hero, stats, featured agents moeten stacken op mobiel
- Agent directory: filters als collapsible sheet op mobiel, grid ‚Üí lijst
- Agent profiel: sidebar info boven of onder op mobiel
- Dashboard: sidebar als hamburger menu op mobiel (Sheet component)
- Messaging: full-screen conversatie op mobiel (geen split view)
- Admin: tabel scrolling op mobiel (horizontal scroll)
- Formulieren: full-width inputs op mobiel

### Accessibility Audit
- [ ] Alle pagina's hebben een <main> element
- [ ] Heading hi√´rarchie klopt (h1 ‚Üí h2 ‚Üí h3, geen gaps)
- [ ] Alle interactieve elementen zijn keyboard-bereikbaar (Tab)
- [ ] Alle knoppen en links hebben descriptieve tekst (geen "klik hier")
- [ ] Alle formulier velden hebben labels
- [ ] Focus ring is zichtbaar op alle interactieve elementen
- [ ] Kleurcontrast voldoet aan WCAG AA (check brand kleuren)
- [ ] Loading states zijn aangekondigd (aria-live regions of skeleton)
- [ ] Afbeeldingen hebben alt tekst

Git: git add . && git commit -m "feat: responsive design and accessibility improvements"

==========================================================================
STAP 8: FINALE DOCUMENTATIE & VERIFICATIE
==========================================================================

### README.md ‚Äî Complete Herschrijving
```markdown
# AgentLink ‚Äî Open Platform voor AI Agent Discovery

[korte beschrijving]

## Features
- Agent registratie (web + API)
- Zoeken en filteren
- Ratings & reviews
- Skill endorsements
- Agent-to-agent messaging
- Webhooks
- Admin panel

## Quick Start
[stap-voor-stap lokale setup]

## Environment Variables
[tabel met alle vars]

## API
[link naar /docs pagina + korte endpoint lijst]

## Tech Stack
[tabel]

## Project Structuur
[mapoverzicht]

## Contributing
[basis richtlijnen]

## License
[licentie]
```

### Documentatie Completeness Check
- [ ] ALLE info_*.md bestanden zijn up-to-date
- [ ] docs/api-spec.md is compleet en klopt met de code
- [ ] docs/decisions.md bevat alle architectuurbeslissingen
- [ ] docs/backlog.md bevat alle bekende verbeterpunten
- [ ] .env.example is compleet

### Volledige Verificatie Checklist

**Functionaliteit:**
‚ñ° Landing page laadt snel en toont live statistieken
‚ñ° Agent directory: zoeken, filteren, sorteren werkt
‚ñ° Agent profiel: toont alle info, reviews, endorsements
‚ñ° Login via GitHub werkt
‚ñ° Onboarding flow werkt voor nieuwe users
‚ñ° Agent aanmaken via wizard werkt
‚ñ° Agent aanmaken via API werkt
‚ñ° Agent zoeken via API werkt
‚ñ° Reviews plaatsen en lezen werkt
‚ñ° Endorsements geven en bekijken werkt
‚ñ° Messaging: gesprek starten en berichten sturen werkt
‚ñ° Webhooks: registreren en ontvangen werkt
‚ñ° API keys: aanmaken, gebruiken, revoken werkt
‚ñ° Admin panel: agents modereren werkt
‚ñ° Admin panel: reviews modereren werkt
‚ñ° Admin panel: users beheren werkt
‚ñ° Admin panel: audit log werkt
‚ñ° Activity feed toont events

**Discovery:**
‚ñ° /.well-known/agent-card.json retourneert geldige JSON
‚ñ° /.well-known/agents.json retourneert geldige JSON met actuele count
‚ñ° /sitemap.xml bevat alle publieke pagina's
‚ñ° /robots.txt verwijst naar sitemap
‚ñ° /api/v1/openapi.json retourneert geldige OpenAPI spec
‚ñ° Alle agent profielpagina's hebben JSON-LD structured data
‚ñ° Alle pagina's hebben correcte meta tags

**Security:**
‚ñ° Security headers aanwezig
‚ñ° CSP actief
‚ñ° Alle inputs gevalideerd
‚ñ° Geen stack traces in productie
‚ñ° Rate limiting werkt op alle endpoints
‚ñ° pnpm audit toont geen kritieke vulnerabilities

**Performance:**
‚ñ° Landing page laadt < 3 seconden
‚ñ° pnpm run build slaagt zonder warnings
‚ñ° Geen console errors in de browser

**Responsive:**
‚ñ° Alle pagina's werken op mobiel (375px)
‚ñ° Alle pagina's werken op tablet (768px)
‚ñ° Alle pagina's werken op desktop (1280px)

### Final Git
git add . && git commit -m "chore: v1.0 ‚Äî launch ready"
git tag v1.0.0

==========================================================================
SAMENVATTING
==========================================================================

Geef na afloop een COMPLETE samenvatting:

1. ALLE PAGINA'S ‚Äî URL, beschrijving, status
2. ALLE API ENDPOINTS ‚Äî Methode, pad, auth, rate limit
3. DESIGN ‚Äî Kleurenpalet, componenten, responsive breakpoints
4. SECURITY ‚Äî Welke maatregelen zijn actief
5. PERFORMANCE ‚Äî Caching, ISR, bundle splitting
6. BEKENDE BEPERKINGEN ‚Äî Wat is er NIET (post-v1.0)
7. DEPLOYMENT STAPPEN ‚Äî Hoe naar Railway deployen
8. POST-LAUNCH BACKLOG ‚Äî Prioriteitsvolgorde voor v1.1

De deployment stappen moeten concreet zijn:
- Railway project configuratie
- Environment variables instellen
- Database migratie draaien
- DNS configuratie
- Eerste admin user aanmaken
```
